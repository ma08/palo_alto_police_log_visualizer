# Police Report Map Visualization (Next.js Frontend)

This directory contains the Next.js application for visualizing the processed Palo Alto police report data on an interactive map.

## Purpose

- Display geocoded police incidents from `/public/data/incidents.json` on an interactive Google Map.
- Allow users to click on incident markers to view details (case number, offense type, date, address) in an info window.
- Provide an accessible web interface for the analysis results generated by the main project.

## Tech Stack

- [Next.js](https://nextjs.org/) (React Framework)
- [React](https://reactjs.org/)
- [Google Maps Platform](https://developers.google.com/maps) (using [@vis.gl/react-google-maps](https://visgl.github.io/react-google-maps/))
- [Tailwind CSS](https://tailwindcss.com/) (Utility-first CSS framework)
- [Vercel](https://vercel.com/) (Deployment Platform)

## Setup

1.  **Navigate to this directory:**
    ```bash
    cd website
    ```
2.  **Install Dependencies (if not already done during scaffolding):**
    ```bash
    npm install
    # or
    # yarn install

    # Install Tailwind CSS dev dependencies (likely already installed by create-next-app)
    # npm install -D tailwindcss postcss autoprefixer
    # or
    # yarn add -D tailwindcss postcss autoprefixer

    # Install Google Maps library
    npm install @vis.gl/react-google-maps
    # or
    # yarn add @vis.gl/react-google-maps
    ```
3.  **Initialize Tailwind CSS (if not done by create-next-app):**
    ```bash
    # npx tailwindcss init -p
    ```
    *(The scaffolding process likely already created `tailwind.config.ts` and `postcss.config.mjs`)*

4.  **Configure Tailwind Template Paths:**
    - Ensure `tailwind.config.ts` includes paths to your component and page files. The default generated by `create-next-app` should be correct for `src/`:
      ```ts
      import type { Config } from "tailwindcss";

      const config: Config = {
        content: [
          "./src/pages/**/*.{js,ts,jsx,tsx,mdx}",
          "./src/components/**/*.{js,ts,jsx,tsx,mdx}",
          "./src/app/**/*.{js,ts,jsx,tsx,mdx}",
        ],
        theme: {
          extend: {
            backgroundImage: {
              "gradient-radial": "radial-gradient(var(--tw-gradient-stops))",
              "gradient-conic":
                "conic-gradient(from 180deg at 50% 50%, var(--tw-gradient-stops))",
            },
          },
        },
        plugins: [],
      };
      export default config;
      ```
5.  **Add Tailwind Directives:**
    - Ensure the `@tailwind` directives are in `src/app/globals.css` (this should be done by `create-next-app`):
      ```css
      @tailwind base;
      @tailwind components;
      @tailwind utilities;
      ```
6.  **Configure Google Maps API Key:**
    - You will need a Google Maps Platform API key enabled for the Maps JavaScript API.
    - Create a `.env.local` file in this `website` directory.
    - Add your API key to the file:
      ```
      NEXT_PUBLIC_GOOGLE_MAPS_API_KEY="YOUR_FRONTEND_MAPS_API_KEY"
      ```
    - **Important:** Use a *separate* API key for the frontend than the one used for the backend geocoding script. Restrict this frontend key to your website's domain(s) in the Google Cloud Console for security.

7.  **Run Development Server:**
    ```bash
    npm run dev
    # or
    # yarn dev
    ```
    Open [http://localhost:3000](http://localhost:3000) in your browser.

## Data

- The application loads the incident data statically from `/public/data/incidents.json` at build time.
- This file is generated by the `scripts/prepare_website_data.py` script in the parent project. Ensure this script is run before building or running the development server.

## Submodule Status

This directory is managed as a separate Git repository and included in the main `palo_alto_police_report_analysis` project as a Git submodule.

## Current Status & Functionality

- The map successfully displays incident locations loaded from `/public/data/incidents.json`.
- Markers are rendered using `@vis.gl/react-google-maps`.
- Clicking a marker opens an `InfoWindow` showing key details for that incident (case number, offense type, date, address, Google Maps link).
- Basic marker styling is applied (currently uniform appearance, color differentiation based on `location_interpretation` is planned but not fully working).
- Requires a valid `NEXT_PUBLIC_GOOGLE_MAPS_API_KEY` in `.env.local`.

## Future Enhancements / Next Steps

- **Marker Styling:** Resolve the issue causing markers to have a uniform appearance; implement distinct colors/icons based on `location_interpretation` or `offense_type`.
- **Data Loading:** Consider client-side fetching or server-side rendering for larger datasets if static import becomes too slow.
- **Filtering/Search:** Add controls to filter incidents by date range, offense type, etc.
- **PDF Linking:** Integrate links to the original PDF reports if available.
- **Clustering:** Implement marker clustering for better performance and usability when many markers are close together.
- **UI Improvements:** Enhance the overall UI/UX, potentially adding a sidebar for details or filters.
- **Submodule Management:** Ensure the submodule is properly configured and pushed to its own remote repository.
